#!/bin/bash
echo "🚀 완전히 새로운 터미널 세션에서 ROS2 환경 설정"
echo "==============================================="

# 현재 쉘 세션을 완전히 종료하고 새로운 세션 시작
echo "⚠️  현재 쉘 세션을 종료하고 새로운 세션을 시작합니다."
echo "이 스크립트를 실행한 후 다음 명령어들을 순서대로 실행하세요:"
echo ""
echo "1️⃣ 새로운 터미널을 열고 다음 명령어 실행:"
echo "   source ~/gap_detect_v1_ws/scripts/setup_ros2_fresh_session.sh"
echo ""
echo "2️⃣ 그 다음 두산 로봇 명령어 실행:"
echo "   ros2 launch dsr_bringup2 dsr_bringup2_rviz.launch.py mode:=real host:=192.168.137.100 port:=12345 model:=a0912"
echo ""
echo "3️⃣ 만약 여전히 연결이 안 된다면 가상 모드로 테스트:"
echo "   ros2 launch dsr_bringup2 dsr_bringup2_rviz.launch.py mode:=virtual host:=127.0.0.1 port:=12345 model:=a0912"
echo ""
echo "💡 로봇 연결 문제 해결 방법:"
echo "=========================="
echo ""
echo "🔧 로봇 컨트롤러 설정 확인:"
echo "1. 로봇 컨트롤러 전원이 켜져 있는지 확인"
echo "2. 로봇 컨트롤러에서 TCP/IP 서비스가 활성화되어 있는지 확인"
echo "3. 로봇 설정에서 포트 12345가 열려있는지 확인"
echo "4. 로봇 IP 주소가 192.168.137.100이 맞는지 확인"
echo ""
echo "🌐 네트워크 설정 확인:"
echo "1. 노트북과 로봇이 같은 네트워크에 있는지 확인"
echo "2. 방화벽이 포트 12345를 차단하지 않는지 확인"
echo "3. 로봇 컨트롤러 재시작 후 TCP/IP 서비스 재활성화"
echo ""
echo "🔄 대안 방법:"
echo "1. 로봇 컨트롤러를 재시작"
echo "2. 로봇 설정에서 TCP/IP 서비스를 비활성화 후 재활성화"
echo "3. 다른 포트 번호 시도 (예: 12346)"
echo "4. 로봇 모델이 a0912가 맞는지 확인"
echo ""
echo "📞 로봇 연결 테스트 명령어:"
echo "ping 192.168.137.100"
echo "telnet 192.168.137.100 12345"
echo "nmap -p 12345 192.168.137.100"
echo ""
